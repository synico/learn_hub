# 加权操作

#### 1. 加权操作可以在生成索引时执行，也可以在执行搜索时执行。

#### 2. 加权文档（boosting documents）
通过改变文档的加权因子，可指示lucene在计算相关性时或多或少地考虑到该文档针对索引中其他文档的重要程度。

#### 3. 加权字段（boosting fields）
1) 当加权一个文档时，lucene在内部采用同一个加权因子对该文档中的字段加权。  
2) 改变一个字段或文档的加权因子时，必须完全删除并重新创建对应的文档，或使用updateDocument方法达到相同的效果。  
3) 较短的字段有一个隐含的加权，这取决于lucene的评分算法具体实现。在生成索引时，lucene调用Similarity.lengthNorm方法来实现该算法。  
4) lucene依据文档对查询语句的匹配程度来对搜索结果排名，每个匹配文档都有一个评分，lucene的评分机制包含大量的因子，其中就有加权因子。

#### 4. 加权基准（norms）
1) 在索引期间，文档中字段的所有加权值都被合并成一个单一的浮点数。除了字段，文档也有自己的加权值，Lucene会基于字段的语汇单元（token）数量自动计算出这些加权值（更短的字段具有更高的加权）。这些加权被合并到一处，并被编码成一个单一的字节值，作为字段或文档信息的一部分存储起来。在搜索期间，被搜索字段的norms都被加载到内存，并被解码还原为浮点数，然后用于计算相关性评分。  
2) norms的全部数组需要在加载至内存时，需要对被搜索文档的每个字段都分配一个字节空间。对于文档中包含多个字段的较大索引来说，这个加载操作会很快占用大量内存空间。  
3) 可使用Field.setOmitNorms(true)来关闭norms选项。
